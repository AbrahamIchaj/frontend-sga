<section class="upload-page">
  <div class="upload-wrapper">
    <aside class="upload-info">
      <span class="upload-info__badge"> Importación CSV </span>
      <h1>Migración de Catálogo de Insumos</h1>
      <p>
        Carga un archivo CSV en formato UTF-8 con la información de los insumos.
      </p>

      <ul class="upload-tips">
        <li>
          <i class="fa-regular fa-circle-check"></i>
          Asegúrate del formato en que se esta solicitando
        </li>
        <li>
          <i class="fa-regular fa-circle-check"></i>
          Puedes convertir un excel en el formato necesario exportándolo como
          CSV y eligiendo el formato requerido.
        </li>
      </ul>
    </aside>

    <article class="upload-card">
      <label class="dropzone" [class.dropzone--loading]="isLoading">
        <div class="dropzone__icon">
          <i class="fa-solid fa-cloud-arrow-up"></i>
        </div>
        <div class="dropzone__copy">
          <span class="dropzone__title">Arrastra y suelta tu archivo</span>
          <span class="dropzone__subtitle"
            >o haz clic para seleccionarlo (solo .csv) <br
          /></span>

          <span *ngIf="selectedFile" class="dropzone__file">
            <i class="fa-regular fa-file-lines"></i>
            {{ selectedFile.name }}
          </span>
        </div>
        <input
          type="file"
          class="hidden"
          accept=".csv"
          (change)="onFileSelected($event)"
        />
      </label>

      <div class="upload-feedback">
        <div *ngIf="message" class="alert alert--success">
          <i class="fa-regular fa-circle-check"></i>
          <span>{{ message }}</span>
        </div>

        <div *ngIf="error" class="alert alert--error">
          <i class="fa-regular fa-circle-xmark"></i>
          <span>{{ error }}</span>
        </div>
      </div>

      <div class="upload-actions">
        <button
          (click)="onUpload()"
          [disabled]="!selectedFile || isLoading"
          class="upload-actions__primary"
        >
          <ng-container *ngIf="isLoading && !isCancelling; else uploadCopy">
            <i class="fa-solid fa-upload"></i>
            Procesando...
          </ng-container>
          <ng-template #uploadCopy>Subir archivo</ng-template>
        </button>

        <button
          *ngIf="isLoading"
          (click)="onCancel()"
          [disabled]="isCancelling"
          class="upload-actions__secondary"
        >
          <ng-container *ngIf="isCancelling; else cancelCopy">
            <svg
              class="upload-spinner"
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
            >
              <circle
                class="upload-spinner__track"
                cx="12"
                cy="12"
                r="10"
                stroke="currentColor"
                stroke-width="4"
              ></circle>
              <path
                class="upload-spinner__fill"
                fill="currentColor"
                d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
              ></path>
            </svg>
            Cancelando...
          </ng-container>
          <ng-template #cancelCopy>Cancelar</ng-template>
        </button>
      </div>
    </article>
  </div>
</section>
